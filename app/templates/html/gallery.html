{% extends 'base.html' %}
{% load static %}
{% block title %}Gallery | Assemblies of God Church{% endblock %}

{% block extra_head %}
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- AOS Animation CSS -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<style>
   body {
      background: #111;
      font-family: Arial, sans-serif;
      color: #f8f9fa;
      opacity: 0;
      animation: fadeIn 1s ease-in forwards;
   }
   @keyframes fadeIn { to { opacity: 1; } }
   h2 { font-weight: bold; color: #fff; }
   .gallery-card {
      background: #1c1c1c;
      border: none;
      border-radius: 15px;
      overflow: hidden;
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
   }
   .gallery-card:hover {
      transform: translateY(-5px);
      box-shadow: 0px 6px 20px rgba(255,255,255,0.15);
   }
   .gallery-card .card-body { color: #f1f1f1; }
   .gallery-card .card-title { color: #fff; font-weight: 600; }
   .card-text.text-muted { color: #bbb !important; }
   .card-img-top { height: 200px; object-fit: cover; }
   .card { height: 100%; }
   .modal-content { background: #1c1c1c; color: #fff; border-radius: 15px; border: none; }
   .carousel-control-prev-icon, .carousel-control-next-icon { filter: invert(1); }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
   <h2 class="text-center mb-5" data-aos="fade-down">Gallery</h2>
   <div class="row g-4">
      {% for post in posts %}
      <div class="col-md-4" data-aos="zoom-in" data-aos-delay="{{ forloop.counter0|add:100 }}">
         <div class="card gallery-card" data-bs-toggle="modal" data-bs-target="#galleryModal{{ post.id }}">
            <!-- Show first image as preview -->
            {% if post.images.all %}
               {% with first_image=post.images.all.0 %}
                  <img src="{{ first_image.image.url }}" class="card-img-top" alt="Gallery Preview">
               {% endwith %}
            {% endif %}
            <div class="card-body">
               <h5 class="card-title">{{ post.topic }}</h5>
               <p class="card-text text-muted">Posted on: {{ post.uploaded_at|date:"M d, Y" }}</p>
            </div>
         </div>
      </div>
      {% empty %}
      <p class="text-center text-muted">No posts uploaded yet.</p>
      {% endfor %}
   </div>
</div>

<!-- Modals for each post -->
{% for post in posts %}
<div class="modal fade" id="galleryModal{{ post.id }}" tabindex="-1" aria-hidden="true">
   <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
         <div class="modal-body">
            <!-- Show all images of this post -->
            {% for img in post.images.all %}
               <img src="{{ img.image.url }}" class="d-block w-100 mb-2" alt="{{ post.topic }}">
            {% endfor %}
         </div>
      </div>
   </div>
</div>
{% endfor %}
{% endblock %}

{% block extra_js %}
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- AOS JS -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
   AOS.init({ duration: 1000, once: true });
</script>
{% endblock %}
